import{o as ie,L as at,u as nt,M as ot,q as lt,N as it,O as X,r as $,g as m,P as rt,R as wt,w as L,h as V,v as He,x as ge,S as xe,j as d,y as Ie,m as pe,i as ye,U as Ct,V as Ee,W as st,X as kt,Y as xt,k as St,Z as Tt,_ as qt,$ as Pt,a0 as _t,a1 as we,a2 as Be,a3 as Me,a4 as Le,a5 as ut,a6 as Bt,n as Lt,a7 as $t,a8 as zt,a9 as Re,aa as Ot,ab as Qe,ac as Dt,ad as Ft,ae as Et,af as Ht,ag as Nt,ah as Ue,f as je,ai as At,e as We,b as Ke,T as It,aj as Mt,s as ct,ak as Rt,al as dt,am as Ge,Q as de,an as me,F as Qt,ao as Se,ap as Ut,aq as jt,ar as Wt,as as Kt,A as Gt,at as Xt,B as oe,au as Xe,E as N,D as A,av as Ye,aw as fe,ax as Ce,ay as Yt,az as Zt,C as ve,aA as $e,aB as Ze,aC as Je,G as he,aD as Jt,aE as Vt,aF as ea,aG as ta,aH as ze}from"./index.e157fded.js";import{T as Oe,b as ke}from"./format.756cc053.js";import{u as aa,a as na,b as oa}from"./use-fullscreen.fe939f56.js";import{d as Ve}from"./dateTime.13d8e292.js";import"./touch.70a9dd44.js";const et=150,la=ie({name:"QDrawer",inheritAttrs:!1,props:{...at,...nt,side:{type:String,default:"left",validator:e=>["left","right"].includes(e)},width:{type:Number,default:300},mini:Boolean,miniToOverlay:Boolean,miniWidth:{type:Number,default:57},breakpoint:{type:Number,default:1023},showIfAbove:Boolean,behavior:{type:String,validator:e=>["default","desktop","mobile"].includes(e),default:"default"},bordered:Boolean,elevated:Boolean,overlay:Boolean,persistent:Boolean,noSwipeOpen:Boolean,noSwipeClose:Boolean,noSwipeBackdrop:Boolean},emits:[...ot,"onLayout","miniState"],setup(e,{slots:t,emit:a,attrs:n}){const r=ye(),{proxy:{$q:f}}=r,c=lt(e,f),{preventBodyScroll:v}=Ct(),{registerTimeout:u,removeTimeout:b}=it(),i=Ee(st,X);if(i===X)return console.error("QDrawer needs to be child of QLayout"),X;let S,p=null,y;const k=$(e.behavior==="mobile"||e.behavior!=="desktop"&&i.totalWidth.value<=e.breakpoint),z=m(()=>e.mini===!0&&k.value!==!0),_=m(()=>z.value===!0?e.miniWidth:e.width),w=$(e.showIfAbove===!0&&k.value===!1?!0:e.modelValue===!0),I=m(()=>e.persistent!==!0&&(k.value===!0||se.value===!0));function h(s,x){if(g(),s!==!1&&i.animate(),M(0),k.value===!0){const R=i.instances[j.value];R!==void 0&&R.belowBreakpoint===!0&&R.hide(!1),Z(1),i.isContainer.value!==!0&&v(!0)}else Z(0),s!==!1&&qe(!1);u(()=>{s!==!1&&qe(!0),x!==!0&&a("show",s)},et)}function C(s,x){F(),s!==!1&&i.animate(),Z(0),M(Q.value*_.value),Pe(),x!==!0?u(()=>{a("hide",s)},et):b()}const{show:q,hide:P}=rt({showing:w,hideOnRouteChange:I,handleShow:h,handleHide:C}),{addToHistory:g,removeFromHistory:F}=wt(w,P,I),E={belowBreakpoint:k,hide:P},H=m(()=>e.side==="right"),Q=m(()=>(f.lang.rtl===!0?-1:1)*(H.value===!0?1:-1)),re=$(0),W=$(!1),ee=$(!1),te=$(_.value*Q.value),j=m(()=>H.value===!0?"left":"right"),ae=m(()=>w.value===!0&&k.value===!1&&e.overlay===!1?e.miniToOverlay===!0?e.miniWidth:_.value:0),ne=m(()=>e.overlay===!0||e.miniToOverlay===!0||i.view.value.indexOf(H.value?"R":"L")>-1||f.platform.is.ios===!0&&i.isContainer.value===!0),K=m(()=>e.overlay===!1&&w.value===!0&&k.value===!1),se=m(()=>e.overlay===!0&&w.value===!0&&k.value===!1),ue=m(()=>"fullscreen q-drawer__backdrop"+(w.value===!1&&W.value===!1?" hidden":"")),ce=m(()=>({backgroundColor:`rgba(0,0,0,${re.value*.4})`})),B=m(()=>H.value===!0?i.rows.value.top[2]==="r":i.rows.value.top[0]==="l"),G=m(()=>H.value===!0?i.rows.value.bottom[2]==="r":i.rows.value.bottom[0]==="l"),D=m(()=>{const s={};return i.header.space===!0&&B.value===!1&&(ne.value===!0?s.top=`${i.header.offset}px`:i.header.space===!0&&(s.top=`${i.header.size}px`)),i.footer.space===!0&&G.value===!1&&(ne.value===!0?s.bottom=`${i.footer.offset}px`:i.footer.space===!0&&(s.bottom=`${i.footer.size}px`)),s}),Y=m(()=>{const s={width:`${_.value}px`,transform:`translateX(${te.value}px)`};return k.value===!0?s:Object.assign(s,D.value)}),Te=m(()=>"q-drawer__content fit "+(i.isContainer.value!==!0?"scroll":"overflow-auto")),o=m(()=>`q-drawer q-drawer--${e.side}`+(ee.value===!0?" q-drawer--mini-animate":"")+(e.bordered===!0?" q-drawer--bordered":"")+(c.value===!0?" q-drawer--dark q-dark":"")+(W.value===!0?" no-transition":w.value===!0?"":" q-layout--prevent-focus")+(k.value===!0?" fixed q-drawer--on-top q-drawer--mobile q-drawer--top-padding":` q-drawer--${z.value===!0?"mini":"standard"}`+(ne.value===!0||K.value!==!0?" fixed":"")+(e.overlay===!0||e.miniToOverlay===!0?" q-drawer--on-top":"")+(B.value===!0?" q-drawer--top-padding":""))),l=m(()=>{const s=f.lang.rtl===!0?e.side:j.value;return[[Oe,yt,void 0,{[s]:!0,mouse:!0}]]}),T=m(()=>{const s=f.lang.rtl===!0?j.value:e.side;return[[Oe,Ae,void 0,{[s]:!0,mouse:!0}]]}),O=m(()=>{const s=f.lang.rtl===!0?j.value:e.side;return[[Oe,Ae,void 0,{[s]:!0,mouse:!0,mouseAllDir:!0}]]});function U(){bt(k,e.behavior==="mobile"||e.behavior!=="desktop"&&i.totalWidth.value<=e.breakpoint)}L(k,s=>{s===!0?(S=w.value,w.value===!0&&P(!1)):e.overlay===!1&&e.behavior!=="mobile"&&S!==!1&&(w.value===!0?(M(0),Z(0),Pe()):q(!1))}),L(()=>e.side,(s,x)=>{i.instances[x]===E&&(i.instances[x]=void 0,i[x].space=!1,i[x].offset=0),i.instances[s]=E,i[s].size=_.value,i[s].space=K.value,i[s].offset=ae.value}),L(i.totalWidth,()=>{(i.isContainer.value===!0||document.qScrollPrevented!==!0)&&U()}),L(()=>e.behavior+e.breakpoint,U),L(i.isContainer,s=>{w.value===!0&&v(s!==!0),s===!0&&U()}),L(i.scrollbarWidth,()=>{M(w.value===!0?0:void 0)}),L(ae,s=>{J("offset",s)}),L(K,s=>{a("onLayout",s),J("space",s)}),L(H,()=>{M()}),L(_,s=>{M(),_e(e.miniToOverlay,s)}),L(()=>e.miniToOverlay,s=>{_e(s,_.value)}),L(()=>f.lang.rtl,()=>{M()}),L(()=>e.mini,()=>{e.modelValue===!0&&(pt(),i.animate())}),L(z,s=>{a("miniState",s)});function M(s){s===void 0?V(()=>{s=w.value===!0?0:_.value,M(Q.value*s)}):(i.isContainer.value===!0&&H.value===!0&&(k.value===!0||Math.abs(s)===_.value)&&(s+=Q.value*i.scrollbarWidth.value),te.value=s)}function Z(s){re.value=s}function qe(s){const x=s===!0?"remove":i.isContainer.value!==!0?"add":"";x!==""&&document.body.classList[x]("q-body--drawer-toggle")}function pt(){p!==null&&clearTimeout(p),r.proxy&&r.proxy.$el&&r.proxy.$el.classList.add("q-drawer--mini-animate"),ee.value=!0,p=setTimeout(()=>{p=null,ee.value=!1,r&&r.proxy&&r.proxy.$el&&r.proxy.$el.classList.remove("q-drawer--mini-animate")},150)}function yt(s){if(w.value!==!1)return;const x=_.value,R=ke(s.distance.x,0,x);if(s.isFinal===!0){R>=Math.min(75,x)===!0?q():(i.animate(),Z(0),M(Q.value*x)),W.value=!1;return}M((f.lang.rtl===!0?H.value!==!0:H.value)?Math.max(x-R,0):Math.min(0,R-x)),Z(ke(R/x,0,1)),s.isFirst===!0&&(W.value=!0)}function Ae(s){if(w.value!==!0)return;const x=_.value,R=s.direction===e.side,be=(f.lang.rtl===!0?R!==!0:R)?ke(s.distance.x,0,x):0;if(s.isFinal===!0){Math.abs(be)<Math.min(75,x)===!0?(i.animate(),Z(1),M(0)):P(),W.value=!1;return}M(Q.value*be),Z(ke(1-be/x,0,1)),s.isFirst===!0&&(W.value=!0)}function Pe(){v(!1),qe(!0)}function J(s,x){i.update(e.side,s,x)}function bt(s,x){s.value!==x&&(s.value=x)}function _e(s,x){J("size",s===!0?e.miniWidth:x)}return i.instances[e.side]=E,_e(e.miniToOverlay,_.value),J("space",K.value),J("offset",ae.value),e.showIfAbove===!0&&e.modelValue!==!0&&w.value===!0&&e["onUpdate:modelValue"]!==void 0&&a("update:modelValue",!0),He(()=>{a("onLayout",K.value),a("miniState",z.value),S=e.showIfAbove===!0;const s=()=>{(w.value===!0?h:C)(!1,!0)};if(i.totalWidth.value!==0){V(s);return}y=L(i.totalWidth,()=>{y(),y=void 0,w.value===!1&&e.showIfAbove===!0&&k.value===!1?q(!1):s()})}),ge(()=>{y!==void 0&&y(),p!==null&&(clearTimeout(p),p=null),w.value===!0&&Pe(),i.instances[e.side]===E&&(i.instances[e.side]=void 0,J("size",0),J("offset",0),J("space",!1))}),()=>{const s=[];k.value===!0&&(e.noSwipeOpen===!1&&s.push(xe(d("div",{key:"open",class:`q-drawer__opener fixed-${e.side}`,"aria-hidden":"true"}),l.value)),s.push(Ie("div",{ref:"backdrop",class:ue.value,style:ce.value,"aria-hidden":"true",onClick:P},void 0,"backdrop",e.noSwipeBackdrop!==!0&&w.value===!0,()=>O.value)));const x=z.value===!0&&t.mini!==void 0,R=[d("div",{...n,key:""+x,class:[Te.value,n.class]},x===!0?t.mini():pe(t.default))];return e.elevated===!0&&w.value===!0&&R.push(d("div",{class:"q-layout__shadow absolute-full overflow-hidden no-pointer-events"})),s.push(Ie("aside",{ref:"content",class:o.value,style:Y.value},R,"contentclose",e.noSwipeClose!==!0&&k.value===!0,()=>T.value)),d("div",{class:"q-drawer-container"},s)}}}),ia=[d("circle",{cx:"15",cy:"15",r:"15"},[d("animate",{attributeName:"r",from:"15",to:"15",begin:"0s",dur:"0.8s",values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}),d("animate",{attributeName:"fill-opacity",from:"1",to:"1",begin:"0s",dur:"0.8s",values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"})]),d("circle",{cx:"60",cy:"15",r:"9","fill-opacity":".3"},[d("animate",{attributeName:"r",from:"9",to:"9",begin:"0s",dur:"0.8s",values:"9;15;9",calcMode:"linear",repeatCount:"indefinite"}),d("animate",{attributeName:"fill-opacity",from:".5",to:".5",begin:"0s",dur:"0.8s",values:".5;1;.5",calcMode:"linear",repeatCount:"indefinite"})]),d("circle",{cx:"105",cy:"15",r:"15"},[d("animate",{attributeName:"r",from:"15",to:"15",begin:"0s",dur:"0.8s",values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}),d("animate",{attributeName:"fill-opacity",from:"1",to:"1",begin:"0s",dur:"0.8s",values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"})])],ra=ie({name:"QSpinnerDots",props:kt,setup(e){const{cSize:t,classes:a}=xt(e);return()=>d("svg",{class:a.value,fill:"currentColor",width:t.value,height:t.value,viewBox:"0 0 120 30",xmlns:"http://www.w3.org/2000/svg"},ia)}}),sa=ie({name:"QChatMessage",props:{sent:Boolean,label:String,bgColor:String,textColor:String,name:String,avatar:String,text:Array,stamp:String,size:String,labelHtml:Boolean,nameHtml:Boolean,textHtml:Boolean,stampHtml:Boolean},setup(e,{slots:t}){const a=m(()=>e.sent===!0?"sent":"received"),n=m(()=>`q-message-text-content q-message-text-content--${a.value}`+(e.textColor!==void 0?` text-${e.textColor}`:"")),r=m(()=>`q-message-text q-message-text--${a.value}`+(e.bgColor!==void 0?` text-${e.bgColor}`:"")),f=m(()=>"q-message-container row items-end no-wrap"+(e.sent===!0?" reverse":"")),c=m(()=>e.size!==void 0?`col-${e.size}`:""),v=m(()=>({msg:e.textHtml===!0?"innerHTML":"textContent",stamp:e.stampHtml===!0?"innerHTML":"textContent",name:e.nameHtml===!0?"innerHTML":"textContent",label:e.labelHtml===!0?"innerHTML":"textContent"}));function u(i){return t.stamp!==void 0?[i,d("div",{class:"q-message-stamp"},t.stamp())]:e.stamp?[i,d("div",{class:"q-message-stamp",[v.value.stamp]:e.stamp})]:[i]}function b(i,S){const p=S===!0?i.length>1?y=>y:y=>d("div",[y]):y=>d("div",{[v.value.msg]:y});return i.map((y,k)=>d("div",{key:k,class:r.value},[d("div",{class:n.value},u(p(y)))]))}return()=>{const i=[];t.avatar!==void 0?i.push(t.avatar()):e.avatar!==void 0&&i.push(d("img",{class:`q-message-avatar q-message-avatar--${a.value}`,src:e.avatar,"aria-hidden":"true"}));const S=[];t.name!==void 0?S.push(d("div",{class:`q-message-name q-message-name--${a.value}`},t.name())):e.name!==void 0&&S.push(d("div",{class:`q-message-name q-message-name--${a.value}`,[v.value.name]:e.name})),t.default!==void 0?S.push(b(St(t.default()),!0)):e.text!==void 0&&S.push(b(e.text)),i.push(d("div",{class:c.value},S));const p=[];return t.label!==void 0?p.push(d("div",{class:"q-message-label"},t.label())):e.label!==void 0&&p.push(d("div",{class:"q-message-label",[v.value.label]:e.label})),p.push(d("div",{class:f.value},i)),d("div",{class:`q-message q-message-${a.value}`},p)}}}),{passive:le}=_t,ua=ie({name:"QInfiniteScroll",props:{offset:{type:Number,default:500},debounce:{type:[String,Number],default:100},scrollTarget:{default:void 0},initialIndex:Number,disable:Boolean,reverse:Boolean},emits:["load"],setup(e,{slots:t,emit:a}){const n=$(!1),r=$(!0),f=$(null),c=$(null);let v=e.initialIndex||0,u,b;const i=m(()=>"q-infinite-scroll__loading"+(n.value===!0?"":" invisible"));function S(){if(e.disable===!0||n.value===!0||r.value===!1)return;const g=we(u),F=Be(u),E=Me(u);e.reverse===!1?Math.round(F+E+e.offset)>=Math.round(g)&&p():Math.round(F)<=e.offset&&p()}function p(){if(e.disable===!0||n.value===!0||r.value===!1)return;v++,n.value=!0;const g=we(u);a("load",v,F=>{r.value===!0&&(n.value=!1,V(()=>{if(e.reverse===!0){const E=we(u),H=Be(u),Q=E-g;Le(u,H+Q)}F===!0?z():f.value&&f.value.closest("body")&&b()}))})}function y(){v=0}function k(){r.value===!1&&(r.value=!0,u.addEventListener("scroll",b,le)),S()}function z(){r.value===!0&&(r.value=!1,n.value=!1,u.removeEventListener("scroll",b,le),b!==void 0&&b.cancel!==void 0&&b.cancel())}function _(){if(u&&r.value===!0&&u.removeEventListener("scroll",b,le),u=ut(f.value,e.scrollTarget),r.value===!0){if(u.addEventListener("scroll",b,le),e.reverse===!0){const g=we(u),F=Me(u);Le(u,g-F)}S()}}function w(g){v=g}function I(g){g=parseInt(g,10);const F=b;b=g<=0?S:Bt(S,isNaN(g)===!0?100:g),u&&r.value===!0&&(F!==void 0&&u.removeEventListener("scroll",F,le),u.addEventListener("scroll",b,le))}function h(g){if(C.value===!0){if(c.value===null){g!==!0&&V(()=>{h(!0)});return}const F=`${n.value===!0?"un":""}pauseAnimations`;Array.from(c.value.getElementsByTagName("svg")).forEach(E=>{E[F]()})}}const C=m(()=>e.disable!==!0&&r.value===!0);L([n,C],()=>{h()}),L(()=>e.disable,g=>{g===!0?z():k()}),L(()=>e.reverse,()=>{n.value===!1&&r.value===!0&&S()}),L(()=>e.scrollTarget,_),L(()=>e.debounce,I);let q=!1;Tt(()=>{q!==!1&&u&&Le(u,q)}),qt(()=>{q=u?Be(u):!1}),ge(()=>{r.value===!0&&u.removeEventListener("scroll",b,le)}),He(()=>{I(e.debounce),_(),n.value===!1&&h()});const P=ye();return Object.assign(P.proxy,{poll:()=>{b!==void 0&&b()},trigger:p,stop:z,reset:y,resume:k,setIndex:w}),()=>{const g=Pt(t.default,[]);return C.value===!0&&g[e.reverse===!1?"push":"unshift"](d("div",{ref:c,class:i.value},pe(t.loading))),d("div",{class:"q-infinite-scroll",ref:f},g)}}});function ft(e,t){if(t&&e===t)return null;const a=e.nodeName.toLowerCase();if(["div","li","ul","ol","blockquote"].includes(a)===!0)return e;const n=window.getComputedStyle?window.getComputedStyle(e):e.currentStyle,r=n.display;return r==="block"||r==="table"?e:ft(e.parentNode)}function De(e,t,a){return!e||e===document.body?!1:a===!0&&e===t||(t===document?document.body:t).contains(e.parentNode)}function vt(e,t,a){if(a||(a=document.createRange(),a.selectNode(e),a.setStart(e,0)),t.count===0)a.setEnd(e,t.count);else if(t.count>0)if(e.nodeType===Node.TEXT_NODE)e.textContent.length<t.count?t.count-=e.textContent.length:(a.setEnd(e,t.count),t.count=0);else for(let n=0;t.count!==0&&n<e.childNodes.length;n++)a=vt(e.childNodes[n],t,a);return a}const ca=/^https?:\/\//;class da{constructor(t,a){this.el=t,this.eVm=a,this._range=null}get selection(){if(this.el){const t=document.getSelection();if(De(t.anchorNode,this.el,!0)&&De(t.focusNode,this.el,!0))return t}return null}get hasSelection(){return this.selection!==null?this.selection.toString().length>0:!1}get range(){const t=this.selection;return t!==null&&t.rangeCount?t.getRangeAt(0):this._range}get parent(){const t=this.range;if(t!==null){const a=t.startContainer;return a.nodeType===document.ELEMENT_NODE?a:a.parentNode}return null}get blockParent(){const t=this.parent;return t!==null?ft(t,this.el):null}save(t=this.range){t!==null&&(this._range=t)}restore(t=this._range){const a=document.createRange(),n=document.getSelection();t!==null?(a.setStart(t.startContainer,t.startOffset),a.setEnd(t.endContainer,t.endOffset),n.removeAllRanges(),n.addRange(a)):(n.selectAllChildren(this.el),n.collapseToEnd())}savePosition(){let t=-1,a;const n=document.getSelection(),r=this.el.parentNode;if(n.focusNode&&De(n.focusNode,r))for(a=n.focusNode,t=n.focusOffset;a&&a!==r;)a!==this.el&&a.previousSibling?(a=a.previousSibling,t+=a.textContent.length):a=a.parentNode;this.savedPos=t}restorePosition(t=0){if(this.savedPos>0&&this.savedPos<t){const a=window.getSelection(),n=vt(this.el,{count:this.savedPos});n&&(n.collapse(!1),a.removeAllRanges(),a.addRange(n))}}hasParent(t,a){const n=a?this.parent:this.blockParent;return n!==null?n.nodeName.toLowerCase()===t.toLowerCase():!1}hasParents(t,a,n=this.parent){return n===null?!1:t.includes(n.nodeName.toLowerCase())===!0?!0:a===!0?this.hasParents(t,a,n.parentNode):!1}is(t,a){if(this.selection===null)return!1;switch(t){case"formatBlock":return a==="DIV"&&this.parent===this.el||this.hasParent(a,a==="PRE");case"link":return this.hasParent("A",!0);case"fontSize":return document.queryCommandValue(t)===a;case"fontName":const n=document.queryCommandValue(t);return n===`"${a}"`||n===a;case"fullscreen":return this.eVm.inFullscreen.value;case"viewsource":return this.eVm.isViewingSource.value;case void 0:return!1;default:const r=document.queryCommandState(t);return a!==void 0?r===a:r}}getParentAttribute(t){return this.parent!==null?this.parent.getAttribute(t):null}can(t){if(t==="outdent")return this.hasParents(["blockquote","li"],!0);if(t==="indent")return this.hasParents(["li"],!0);if(t==="link")return this.selection!==null||this.is("link")}apply(t,a,n=Lt){if(t==="formatBlock")["BLOCKQUOTE","H1","H2","H3","H4","H5","H6"].includes(a)&&this.is(t,a)&&(t="outdent",a=null),a==="PRE"&&this.is(t,"PRE")&&(a="P");else if(t==="print"){n();const r=window.open();r.document.write(`
        <!doctype html>
        <html>
          <head>
            <title>Print - ${document.title}</title>
          </head>
          <body>
            <div>${this.el.innerHTML}</div>
          </body>
        </html>
      `),r.print(),r.close();return}else if(t==="link"){const r=this.getParentAttribute("href");if(r===null){const f=this.selectWord(this.selection),c=f?f.toString():"";if(!c.length&&(!this.range||!this.range.cloneContents().querySelector("img")))return;this.eVm.editLinkUrl.value=ca.test(c)?c:"https://",document.execCommand("createLink",!1,this.eVm.editLinkUrl.value),this.save(f.getRangeAt(0))}else this.eVm.editLinkUrl.value=r,this.range.selectNodeContents(this.parent),this.save();return}else if(t==="fullscreen"){this.eVm.toggleFullscreen(),n();return}else if(t==="viewsource"){this.eVm.isViewingSource.value=this.eVm.isViewingSource.value===!1,this.eVm.setContent(this.eVm.props.modelValue),n();return}document.execCommand(t,!1,a),n()}selectWord(t){if(t===null||t.isCollapsed!==!0||t.modify===void 0)return t;const a=document.createRange();a.setStart(t.anchorNode,t.anchorOffset),a.setEnd(t.focusNode,t.focusOffset);const n=a.collapsed?["backward","forward"]:["forward","backward"];a.detach();const r=t.focusNode,f=t.focusOffset;return t.collapse(t.anchorNode,t.anchorOffset),t.modify("move",n[0],"character"),t.modify("move",n[1],"word"),t.extend(r,f),t.modify("extend",n[1],"character"),t.modify("extend",n[0],"word"),t}}const fa=ie({name:"QTooltip",inheritAttrs:!1,props:{...$t,...at,...zt,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null},transitionShow:{default:"jump-down"},transitionHide:{default:"jump-up"},anchor:{type:String,default:"bottom middle",validator:Re},self:{type:String,default:"top middle",validator:Re},offset:{type:Array,default:()=>[14,14],validator:Ot},scrollTarget:{default:void 0},delay:{type:Number,default:0},hideDelay:{type:Number,default:0}},emits:[...ot],setup(e,{slots:t,emit:a,attrs:n}){let r,f;const c=ye(),{proxy:{$q:v}}=c,u=$(null),b=$(!1),i=m(()=>Qe(e.anchor,v.lang.rtl)),S=m(()=>Qe(e.self,v.lang.rtl)),p=m(()=>e.persistent!==!0),{registerTick:y,removeTick:k}=Dt(),{registerTimeout:z}=it(),{transitionProps:_,transitionStyle:w}=Ft(e),{localScrollTarget:I,changeScrollEvent:h,unconfigureScrollTarget:C}=Et(e,se),{anchorEl:q,canShow:P,anchorEvents:g}=Ht({showing:b,configureAnchorEl:K}),{show:F,hide:E}=rt({showing:b,canShow:P,handleShow:W,handleHide:ee,hideOnRouteChange:p,processOnMount:!0});Object.assign(g,{delayShow:ae,delayHide:ne});const{showPortal:H,hidePortal:Q,renderPortal:re}=Nt(c,u,ce,"tooltip");if(v.platform.is.mobile===!0){const B={anchorEl:q,innerRef:u,onClickOutside(D){return E(D),D.target.classList.contains("q-dialog__backdrop")&&ct(D),!0}},G=m(()=>e.modelValue===null&&e.persistent!==!0&&b.value===!0);L(G,D=>{(D===!0?Mt:Ue)(B)}),ge(()=>{Ue(B)})}function W(B){H(),y(()=>{f=new MutationObserver(()=>j()),f.observe(u.value,{attributes:!1,childList:!0,characterData:!0,subtree:!0}),j(),se()}),r===void 0&&(r=L(()=>v.screen.width+"|"+v.screen.height+"|"+e.self+"|"+e.anchor+"|"+v.lang.rtl,j)),z(()=>{H(!0),a("show",B)},e.transitionDuration)}function ee(B){k(),Q(),te(),z(()=>{Q(!0),a("hide",B)},e.transitionDuration)}function te(){f!==void 0&&(f.disconnect(),f=void 0),r!==void 0&&(r(),r=void 0),C(),je(g,"tooltipTemp")}function j(){const B=u.value;q.value===null||!B||At({el:B,offset:e.offset,anchorEl:q.value,anchorOrigin:i.value,selfOrigin:S.value,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function ae(B){if(v.platform.is.mobile===!0){We(),document.body.classList.add("non-selectable");const G=q.value,D=["touchmove","touchcancel","touchend","click"].map(Y=>[G,Y,"delayHide","passiveCapture"]);Ke(g,"tooltipTemp",D)}z(()=>{F(B)},e.delay)}function ne(B){v.platform.is.mobile===!0&&(je(g,"tooltipTemp"),We(),setTimeout(()=>{document.body.classList.remove("non-selectable")},10)),z(()=>{E(B)},e.hideDelay)}function K(){if(e.noParentEvent===!0||q.value===null)return;const B=v.platform.is.mobile===!0?[[q.value,"touchstart","delayShow","passive"]]:[[q.value,"mouseenter","delayShow","passive"],[q.value,"mouseleave","delayHide","passive"]];Ke(g,"anchor",B)}function se(){if(q.value!==null||e.scrollTarget!==void 0){I.value=ut(q.value,e.scrollTarget);const B=e.noParentEvent===!0?j:E;h(I.value,B)}}function ue(){return b.value===!0?d("div",{...n,ref:u,class:["q-tooltip q-tooltip--style q-position-engine no-pointer-events",n.class],style:[n.style,w.value],role:"tooltip"},pe(t.default)):null}function ce(){return d(It,_.value,ue)}return ge(te),Object.assign(c.proxy,{updatePosition:j}),re}});function ht(e,t,a){t.handler?t.handler(e,a,a.caret):a.runCmd(t.cmd,t.param)}function Ne(e){return d("div",{class:"q-editor__toolbar-group"},e)}function mt(e,t,a,n=!1){const r=n||(t.type==="toggle"?t.toggled?t.toggled(e):t.cmd&&e.caret.is(t.cmd,t.param):!1),f=[];if(t.tip&&e.$q.platform.is.desktop){const c=t.key?d("div",[d("small",`(CTRL + ${String.fromCharCode(t.key)})`)]):null;f.push(d(fa,{delay:1e3},()=>[d("div",{innerHTML:t.tip}),c]))}return d(de,{...e.buttonProps.value,icon:t.icon!==null?t.icon:void 0,color:r?t.toggleColor||e.props.toolbarToggleColor:t.color||e.props.toolbarColor,textColor:r&&!e.props.toolbarPush?null:t.textColor||e.props.toolbarTextColor,label:t.label,disable:t.disable?typeof t.disable=="function"?t.disable(e):!0:!1,size:"sm",onClick(c){a&&a(),ht(c,t,e)}},()=>f)}function va(e,t){const a=t.list==="only-icons";let n=t.label,r=t.icon!==null?t.icon:void 0,f,c;function v(){b.component.proxy.hide()}if(a)c=t.options.map(i=>{const S=i.type===void 0?e.caret.is(i.cmd,i.param):!1;return S&&(n=i.tip,r=i.icon!==null?i.icon:void 0),mt(e,i,v,S)}),f=e.toolbarBackgroundClass.value,c=[Ne(c)];else{const i=e.props.toolbarToggleColor!==void 0?`text-${e.props.toolbarToggleColor}`:null,S=e.props.toolbarTextColor!==void 0?`text-${e.props.toolbarTextColor}`:null,p=t.list==="no-icons";c=t.options.map(y=>{const k=y.disable?y.disable(e):!1,z=y.type===void 0?e.caret.is(y.cmd,y.param):!1;z&&(n=y.tip,r=y.icon!==null?y.icon:void 0);const _=y.htmlTip;return d(Se,{active:z,activeClass:i,clickable:!0,disable:k,dense:!0,onClick(w){v(),e.contentRef.value!==null&&e.contentRef.value.focus(),e.caret.restore(),ht(w,y,e)}},()=>[p===!0?null:d(me,{class:z?i:S,side:!0},()=>d(Qt,{name:y.icon!==null?y.icon:void 0})),d(me,_?()=>d("div",{class:"text-no-wrap",innerHTML:y.htmlTip}):y.tip?()=>d("div",{class:"text-no-wrap"},y.tip):void 0)])}),f=[e.toolbarBackgroundClass.value,S]}const u=t.highlight&&n!==t.label,b=d(Ut,{...e.buttonProps.value,noCaps:!0,noWrap:!0,color:u?e.props.toolbarToggleColor:e.props.toolbarColor,textColor:u&&!e.props.toolbarPush?null:e.props.toolbarTextColor,label:t.fixedLabel?t.label:n,icon:t.fixedIcon?t.icon!==null?t.icon:void 0:r,contentClass:f},()=>c);return b}function ha(e){if(e.caret)return e.buttons.value.filter(t=>!e.isViewingSource.value||t.find(a=>a.cmd==="viewsource")).map(t=>Ne(t.map(a=>e.isViewingSource.value&&a.cmd!=="viewsource"?!1:a.type==="slot"?pe(e.slots[a.slot]):a.type==="dropdown"?va(e,a):mt(e,a))))}function ma(e,t,a,n={}){const r=Object.keys(n);if(r.length===0)return{};const f={default_font:{cmd:"fontName",param:e,icon:a,tip:t}};return r.forEach(c=>{const v=n[c];f[c]={cmd:"fontName",param:v,icon:a,tip:v,htmlTip:`<font face="${v}">${v}</font>`}}),f}function ga(e){if(e.caret){const t=e.props.toolbarColor||e.props.toolbarTextColor;let a=e.editLinkUrl.value;const n=()=>{e.caret.restore(),a!==e.editLinkUrl.value&&document.execCommand("createLink",!1,a===""?" ":a),e.editLinkUrl.value=null};return[d("div",{class:`q-mx-xs text-${t}`},`${e.$q.lang.editor.url}: `),d("input",{key:"qedt_btm_input",class:"col q-editor__link-input",value:a,onInput:r=>{Rt(r),a=r.target.value},onKeydown:r=>{if(dt(r)!==!0)switch(r.keyCode){case 13:return Ge(r),n();case 27:Ge(r),e.caret.restore(),(!e.editLinkUrl.value||e.editLinkUrl.value==="https://")&&document.execCommand("unlink"),e.editLinkUrl.value=null;break}}}),Ne([d(de,{key:"qedt_btm_rem",tabindex:-1,...e.buttonProps.value,label:e.$q.lang.label.remove,noCaps:!0,onClick:()=>{e.caret.restore(),document.execCommand("unlink"),e.editLinkUrl.value=null}}),d(de,{key:"qedt_btm_upd",...e.buttonProps.value,label:e.$q.lang.label.update,noCaps:!0,onClick:n})])]}}const pa=Object.prototype.toString,Fe=Object.prototype.hasOwnProperty,ya=new Set(["Boolean","Number","String","Function","Array","Date","RegExp"].map(e=>"[object "+e+"]"));function tt(e){if(e!==Object(e)||ya.has(pa.call(e))===!0||e.constructor&&Fe.call(e,"constructor")===!1&&Fe.call(e.constructor.prototype,"isPrototypeOf")===!1)return!1;let t;for(t in e);return t===void 0||Fe.call(e,t)}function gt(){let e,t,a,n,r,f,c=arguments[0]||{},v=1,u=!1;const b=arguments.length;for(typeof c=="boolean"&&(u=c,c=arguments[1]||{},v=2),Object(c)!==c&&typeof c!="function"&&(c={}),b===v&&(c=this,v--);v<b;v++)if((e=arguments[v])!==null)for(t in e)a=c[t],n=e[t],c!==n&&(u===!0&&n&&((r=Array.isArray(n))||tt(n)===!0)?(r===!0?f=Array.isArray(a)===!0?a:[]:f=tt(a)===!0?a:{},c[t]=gt(u,f,n)):n!==void 0&&(c[t]=n));return c}const ba=ie({name:"QEditor",props:{...nt,...aa,modelValue:{type:String,required:!0},readonly:Boolean,disable:Boolean,minHeight:{type:String,default:"10rem"},maxHeight:String,height:String,definitions:Object,fonts:Object,placeholder:String,toolbar:{type:Array,validator:e=>e.length===0||e.every(t=>t.length),default(){return[["left","center","right","justify"],["bold","italic","underline","strike"],["undo","redo"]]}},toolbarColor:String,toolbarBg:String,toolbarTextColor:String,toolbarToggleColor:{type:String,default:"primary"},toolbarOutline:Boolean,toolbarPush:Boolean,toolbarRounded:Boolean,paragraphTag:{type:String,validator:e=>["div","p"].includes(e),default:"div"},contentStyle:Object,contentClass:[Object,Array,String],square:Boolean,flat:Boolean,dense:Boolean},emits:[...na,"update:modelValue","keydown","click","mouseup","keyup","touchend","focus","blur"],setup(e,{slots:t,emit:a,attrs:n}){const{proxy:r,vnode:f}=ye(),{$q:c}=r,v=lt(e,c),{inFullscreen:u,toggleFullscreen:b}=oa(),i=jt(n,f),S=$(null),p=$(null),y=$(null),k=$(!1),z=m(()=>!e.readonly&&!e.disable);let _,w,I=e.modelValue;document.execCommand("defaultParagraphSeparator",!1,e.paragraphTag),_=window.getComputedStyle(document.body).fontFamily;const h=m(()=>e.toolbarBg?` bg-${e.toolbarBg}`:""),C=m(()=>({type:"a",flat:e.toolbarOutline!==!0&&e.toolbarPush!==!0,noWrap:!0,outline:e.toolbarOutline,push:e.toolbarPush,rounded:e.toolbarRounded,dense:!0,color:e.toolbarColor,disable:!z.value,size:"sm"})),q=m(()=>{const o=c.lang.editor,l=c.iconSet.editor;return{bold:{cmd:"bold",icon:l.bold,tip:o.bold,key:66},italic:{cmd:"italic",icon:l.italic,tip:o.italic,key:73},strike:{cmd:"strikeThrough",icon:l.strikethrough,tip:o.strikethrough,key:83},underline:{cmd:"underline",icon:l.underline,tip:o.underline,key:85},unordered:{cmd:"insertUnorderedList",icon:l.unorderedList,tip:o.unorderedList},ordered:{cmd:"insertOrderedList",icon:l.orderedList,tip:o.orderedList},subscript:{cmd:"subscript",icon:l.subscript,tip:o.subscript,htmlTip:"x<subscript>2</subscript>"},superscript:{cmd:"superscript",icon:l.superscript,tip:o.superscript,htmlTip:"x<superscript>2</superscript>"},link:{cmd:"link",disable:T=>T.caret&&!T.caret.can("link"),icon:l.hyperlink,tip:o.hyperlink,key:76},fullscreen:{cmd:"fullscreen",icon:l.toggleFullscreen,tip:o.toggleFullscreen,key:70},viewsource:{cmd:"viewsource",icon:l.viewSource,tip:o.viewSource},quote:{cmd:"formatBlock",param:"BLOCKQUOTE",icon:l.quote,tip:o.quote,key:81},left:{cmd:"justifyLeft",icon:l.left,tip:o.left},center:{cmd:"justifyCenter",icon:l.center,tip:o.center},right:{cmd:"justifyRight",icon:l.right,tip:o.right},justify:{cmd:"justifyFull",icon:l.justify,tip:o.justify},print:{type:"no-state",cmd:"print",icon:l.print,tip:o.print,key:80},outdent:{type:"no-state",disable:T=>T.caret&&!T.caret.can("outdent"),cmd:"outdent",icon:l.outdent,tip:o.outdent},indent:{type:"no-state",disable:T=>T.caret&&!T.caret.can("indent"),cmd:"indent",icon:l.indent,tip:o.indent},removeFormat:{type:"no-state",cmd:"removeFormat",icon:l.removeFormat,tip:o.removeFormat},hr:{type:"no-state",cmd:"insertHorizontalRule",icon:l.hr,tip:o.hr},undo:{type:"no-state",cmd:"undo",icon:l.undo,tip:o.undo,key:90},redo:{type:"no-state",cmd:"redo",icon:l.redo,tip:o.redo,key:89},h1:{cmd:"formatBlock",param:"H1",icon:l.heading1||l.heading,tip:o.heading1,htmlTip:`<h1 class="q-ma-none">${o.heading1}</h1>`},h2:{cmd:"formatBlock",param:"H2",icon:l.heading2||l.heading,tip:o.heading2,htmlTip:`<h2 class="q-ma-none">${o.heading2}</h2>`},h3:{cmd:"formatBlock",param:"H3",icon:l.heading3||l.heading,tip:o.heading3,htmlTip:`<h3 class="q-ma-none">${o.heading3}</h3>`},h4:{cmd:"formatBlock",param:"H4",icon:l.heading4||l.heading,tip:o.heading4,htmlTip:`<h4 class="q-ma-none">${o.heading4}</h4>`},h5:{cmd:"formatBlock",param:"H5",icon:l.heading5||l.heading,tip:o.heading5,htmlTip:`<h5 class="q-ma-none">${o.heading5}</h5>`},h6:{cmd:"formatBlock",param:"H6",icon:l.heading6||l.heading,tip:o.heading6,htmlTip:`<h6 class="q-ma-none">${o.heading6}</h6>`},p:{cmd:"formatBlock",param:e.paragraphTag,icon:l.heading,tip:o.paragraph},code:{cmd:"formatBlock",param:"PRE",icon:l.code,htmlTip:`<code>${o.code}</code>`},"size-1":{cmd:"fontSize",param:"1",icon:l.size1||l.size,tip:o.size1,htmlTip:`<font size="1">${o.size1}</font>`},"size-2":{cmd:"fontSize",param:"2",icon:l.size2||l.size,tip:o.size2,htmlTip:`<font size="2">${o.size2}</font>`},"size-3":{cmd:"fontSize",param:"3",icon:l.size3||l.size,tip:o.size3,htmlTip:`<font size="3">${o.size3}</font>`},"size-4":{cmd:"fontSize",param:"4",icon:l.size4||l.size,tip:o.size4,htmlTip:`<font size="4">${o.size4}</font>`},"size-5":{cmd:"fontSize",param:"5",icon:l.size5||l.size,tip:o.size5,htmlTip:`<font size="5">${o.size5}</font>`},"size-6":{cmd:"fontSize",param:"6",icon:l.size6||l.size,tip:o.size6,htmlTip:`<font size="6">${o.size6}</font>`},"size-7":{cmd:"fontSize",param:"7",icon:l.size7||l.size,tip:o.size7,htmlTip:`<font size="7">${o.size7}</font>`}}}),P=m(()=>{const o=e.definitions||{},l=e.definitions||e.fonts?gt(!0,{},q.value,o,ma(_,c.lang.editor.defaultFont,c.iconSet.editor.font,e.fonts)):q.value;return e.toolbar.map(T=>T.map(O=>{if(O.options)return{type:"dropdown",icon:O.icon,label:O.label,size:"sm",dense:!0,fixedLabel:O.fixedLabel,fixedIcon:O.fixedIcon,highlight:O.highlight,list:O.list,options:O.options.map(M=>l[M])};const U=l[O];return U?U.type==="no-state"||o[O]&&(U.cmd===void 0||q.value[U.cmd]&&q.value[U.cmd].type==="no-state")?U:Object.assign({type:"toggle"},U):{type:"slot",slot:O}}))}),g={$q:c,props:e,slots:t,inFullscreen:u,toggleFullscreen:b,runCmd:G,isViewingSource:k,editLinkUrl:y,toolbarBackgroundClass:h,buttonProps:C,contentRef:p,buttons:P,setContent:B};L(()=>e.modelValue,o=>{I!==o&&(I=o,B(o,!0))});const F=m(()=>e.toolbar&&e.toolbar.length>0),E=m(()=>{const o={},l=T=>{T.key&&(o[T.key]={cmd:T.cmd,param:T.param})};return P.value.forEach(T=>{T.forEach(O=>{O.options?O.options.forEach(l):l(O)})}),o}),H=m(()=>u.value?e.contentStyle:[{minHeight:e.minHeight,height:e.height,maxHeight:e.maxHeight},e.contentStyle]),Q=m(()=>`q-editor q-editor--${k.value===!0?"source":"default"}`+(e.disable===!0?" disabled":"")+(u.value===!0?" fullscreen column":"")+(e.square===!0?" q-editor--square no-border-radius":"")+(e.flat===!0?" q-editor--flat":"")+(e.dense===!0?" q-editor--dense":"")+(v.value===!0?" q-editor--dark q-dark":"")),re=m(()=>[e.contentClass,"q-editor__content",{col:u.value,"overflow-auto":u.value||e.maxHeight}]),W=m(()=>e.disable===!0?{"aria-disabled":"true"}:e.readonly===!0?{"aria-readonly":"true"}:{});function ee(){if(p.value!==null){const o=`inner${k.value===!0?"Text":"HTML"}`,l=p.value[o];l!==e.modelValue&&(I=l,a("update:modelValue",l))}}function te(o){if(a("keydown",o),o.ctrlKey!==!0||dt(o)===!0){D();return}const l=o.keyCode,T=E.value[l];if(T!==void 0){const{cmd:O,param:U}=T;ct(o),G(O,U,!1)}}function j(o){D(),a("click",o)}function ae(o){if(p.value!==null){const{scrollTop:l,scrollHeight:T}=p.value;w=T-l}g.caret.save(),a("blur",o)}function ne(o){V(()=>{p.value!==null&&w!==void 0&&(p.value.scrollTop=p.value.scrollHeight-w)}),a("focus",o)}function K(o){const l=S.value;if(l!==null&&l.contains(o.target)===!0&&(o.relatedTarget===null||l.contains(o.relatedTarget)!==!0)){const T=`inner${k.value===!0?"Text":"HTML"}`;g.caret.restorePosition(p.value[T].length),D()}}function se(o){const l=S.value;l!==null&&l.contains(o.target)===!0&&(o.relatedTarget===null||l.contains(o.relatedTarget)!==!0)&&(g.caret.savePosition(),D())}function ue(){w=void 0}function ce(o){g.caret.save()}function B(o,l){if(p.value!==null){l===!0&&g.caret.savePosition();const T=`inner${k.value===!0?"Text":"HTML"}`;p.value[T]=o,l===!0&&(g.caret.restorePosition(p.value[T].length),D())}}function G(o,l,T=!0){Y(),g.caret.restore(),g.caret.apply(o,l,()=>{Y(),g.caret.save(),T&&D()})}function D(){setTimeout(()=>{y.value=null,r.$forceUpdate()},1)}function Y(){Wt(()=>{p.value!==null&&p.value.focus({preventScroll:!0})})}function Te(){return p.value}return He(()=>{g.caret=r.caret=new da(p.value,g),B(e.modelValue),D(),document.addEventListener("selectionchange",ce)}),ge(()=>{document.removeEventListener("selectionchange",ce)}),Object.assign(r,{runCmd:G,refreshToolbar:D,focus:Y,getContentEl:Te}),()=>{let o;if(F.value){const l=[d("div",{key:"qedt_top",class:"q-editor__toolbar row no-wrap scroll-x"+h.value},ha(g))];y.value!==null&&l.push(d("div",{key:"qedt_btm",class:"q-editor__toolbar row no-wrap items-center scroll-x"+h.value},ga(g))),o=d("div",{key:"toolbar_ctainer",class:"q-editor__toolbars-container"},l)}return d("div",{ref:S,class:Q.value,style:{height:u.value===!0?"100%":null},...W.value,onFocusin:K,onFocusout:se},[o,d("div",{ref:p,style:H.value,class:re.value,contenteditable:z.value,placeholder:e.placeholder,...i.listeners.value,onInput:ee,onKeydown:te,onClick:j,onBlur:ae,onFocus:ne,onMousedown:ue,onTouchstartPassive:ue})])}}}),wa=ie({name:"QPage",props:{padding:Boolean,styleFn:Function},setup(e,{slots:t}){const{proxy:{$q:a}}=ye(),n=Ee(st,X);if(n===X)return console.error("QPage needs to be a deep child of QLayout"),X;if(Ee(Kt,X)===X)return console.error("QPage needs to be child of QPageContainer"),X;const f=m(()=>{const v=(n.header.space===!0?n.header.size:0)+(n.footer.space===!0?n.footer.size:0);if(typeof e.styleFn=="function"){const u=n.isContainer.value===!0?n.containerHeight.value:a.screen.height;return e.styleFn(v,u)}return{minHeight:n.isContainer.value===!0?n.containerHeight.value-v+"px":a.screen.height===0?v!==0?`calc(100vh - ${v}px)`:"100vh":a.screen.height-v+"px"}}),c=m(()=>`q-page${e.padding===!0?" q-layout-padding":""}`);return()=>d("main",{class:c.value,style:f.value},pe(t.default))}}),Ca={style:{width:"350px"},class:"column full-height"},ka={style:{width:"calc(100% - 351px)"},class:"column full-height q-gutter-none"},xa={class:"q-pa-xs",style:{height:"calc(100% - 200px)"}},Sa={class:"row justify-center q-my-md"},Ta={class:"q-pa-xs q-gutter-sm",style:{height:"200px"}},za=Gt({__name:"chat",setup(e,{expose:t}){const a=$("message"),n=$({contactId:"",friendUsername:""}),r=Xt(),f=$(""),c=$(null),v=$(null),u=$(!1),b=$(!0),i=$([]);function S(h){switch(h.functionName){case"selectContact":{p(h.data);break}}}function p(h){n.value.contactId=h.contactId,n.value.friendUsername=h.friendUsername,h.unReadMessageCount>0&&fe.put("/v1/chat/chat/message/"+h.contactId+"/read/"+h.friendUsername).then(C=>{C.data.code==="00000"&&C.data.result?console.log("\u6D88\u606F\u5DF2\u8BFB\u6210\u529F"):console.log("\u6D88\u606F\u5DF2\u8BFB\u5931\u8D25")}),console.log(n.value)}function y(){fe.get("/v1/chat/chat/messages/"+n.value.contactId+"/page/"+r.getUsername()).then(async h=>{if(h.data.code==="00000"&&h.data.result.content.length>0){let C=h.data.result.content;C.reverse(),i.value=C,await V(),h.data.result.last&&Ce.info("\u5DF2\u5C55\u793A\u6240\u6709\u6D88\u606F"),w(h.data.result.last)}})}async function k(){if(f.value===""){Ce.warn("\u53D1\u9001\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A\uFF01");return}await fe.post("/v1/chat/websocket/send_to_user",{sourceUsername:r.getUsername(),sourceAvatar:r.getAvatar(),contactId:n.value.contactId,content:f.value}).then(async h=>{h.data.code==="00000"&&h.data.result?(i.value.push({avatar:r.getAvatar(),content:f.value,sendDateTime:Ve.now(""),sent:!0}),c.value.sendMessageCurrent(n.value.contactId,f.value),f.value="",await V(),w()):Ce.error("\u6D88\u606F\u53D1\u9001\u5931\u8D25\uFF01")})}function z(h){n.value.contactId&&n.value.contactId===h.contactId?(_(h),fe.put("/v1/chat/chat/message/"+n.value.contactId+"/read/"+n.value.friendUsername).then(C=>{C.data.code==="00000"&&C.data.result?console.log("\u6D88\u606F\u5DF2\u8BFB\u6210\u529F"):console.log("\u6D88\u606F\u5DF2\u8BFB\u5931\u8D25")}),c.value.receiveMessageCurrent(h.contactId,h.content)):c.value.receiveMessageNoCurrent(h.contactId,h.content)}async function _(h){i.value.push({avatar:h.sourceAvatar,content:h.content,sendDateTime:Ve.now(""),sent:!1}),await V(),w()}function w(h=!1){console.log("\u6EDA\u52A8\u6761\u6700\u5E95\u90E8");let C=v.value.$el;C.scrollTo({top:C.scrollHeight,behavior:"smooth"}),b.value&&!h&&setTimeout(()=>{console.log("\u542F\u52A8\u6EDA\u52A8\u6761"),u.value=!0,v.value.resume()},2e3)}function I(h,C){setTimeout(()=>{u.value?fe.get("/v1/chat/chat/messages/"+n.value.contactId+"/page/"+r.getUsername()+"?page="+h).then(q=>{if(q.data.code==="00000")if(q.data.result.content.length>0){let P=q.data.result.content;P=P.reverse(),i.value=P.concat(i.value),C()}else Ce.info("\u6CA1\u6709\u66F4\u591A\u6D88\u606F"),u.value=!1,C()}):(v.value.stop(),b.value&&(v.value.setIndex(0),b.value=!1))},2e3)}return L(()=>n.value.contactId,(h,C)=>{b.value=!0,u.value=!1,v.value.reset(),y()}),t({receiveMessage:z}),(h,C)=>{const q=Yt("router-view");return oe(),Xe(Ye,null,[N(la,{"show-if-above":"",side:"left",behavior:"desktop",elevated:"",mini:""},{default:A(()=>[N(Zt,{class:"fixed-center full-width"},{default:A(()=>[xe((oe(),ve(Se,{clickable:"",active:a.value==="message",class:"text-secondary",onClick:C[0]||(C[0]=P=>a.value="message"),to:"/mashed_potatoes_ui/chat/message"},{default:A(()=>[N(me,{avatar:""},{default:A(()=>[N(de,{round:"",icon:"o_mark_unread_chat_alt",class:$e(a.value==="message"?"bg-secondary text-white":"")},{default:A(()=>[N(Ze,{floating:"",rounded:"",color:"red"},{default:A(()=>[Je("2")]),_:1})]),_:1},8,["class"])]),_:1})]),_:1},8,["active"])),[[ze]]),xe((oe(),ve(Se,{clickable:"",active:a.value==="friend",class:"text-secondary",onClick:C[1]||(C[1]=P=>a.value="friend"),to:"/mashed_potatoes_ui/chat/friend"},{default:A(()=>[N(me,{avatar:""},{default:A(()=>[N(de,{round:"",icon:"o_people_alt",class:$e(a.value==="friend"?"bg-secondary text-white":"")},null,8,["class"])]),_:1})]),_:1},8,["active"])),[[ze]]),xe((oe(),ve(Se,{clickable:"",active:a.value==="setting",class:"text-secondary",onClick:C[2]||(C[2]=P=>a.value="setting")},{default:A(()=>[N(me,{avatar:""},{default:A(()=>[N(de,{round:"",icon:"o_notifications_active",class:$e(a.value==="setting"?"bg-secondary text-white":"")},{default:A(()=>[N(Ze,{floating:"",rounded:"",color:"red"},{default:A(()=>[Je("2")]),_:1})]),_:1},8,["class"])]),_:1})]),_:1},8,["active"])),[[ze]])]),_:1})]),_:1}),N(wa,{class:"row full-height"},{default:A(()=>[he("div",Ca,[N(q,{onEmitChildren:S},{default:A(({Component:P,route:g})=>[(oe(),ve(Jt(P),{ref_key:"routerViewRef",ref:c},null,512))]),_:1})]),N(Vt,{class:"column",vertical:""}),he("div",ka,[he("div",xa,[N(ua,{class:"full-width full-height overflow-auto",onLoad:I,reverse:"",offset:0,ref_key:"scrollAreaRef",ref:v},ea({default:A(()=>[(oe(!0),Xe(Ye,null,ta(i.value,(P,g)=>(oe(),ve(sa,{key:g,avatar:P.avatar,text:[P.content],stamp:P.sendDateTime,sent:P.sent,"text-color":"white","bg-color":P.sent?"secondary":"primary"},null,8,["avatar","text","stamp","sent","bg-color"]))),128))]),_:2},[u.value?{name:"loading",fn:A(()=>[he("div",Sa,[N(ra,{color:"secondary",size:"40px"})])]),key:"0"}:void 0]),1536)]),he("div",Ta,[N(ba,{class:"full-height",modelValue:f.value,"onUpdate:modelValue":C[3]||(C[3]=P=>f.value=P),definitions:{send:{tip:"\u53D1\u9001",icon:"send",label:"\u53D1\u9001",handler:k}},toolbar:[["send"]]},null,8,["modelValue","definitions"])])])]),_:1})],64)}}});export{za as default};
