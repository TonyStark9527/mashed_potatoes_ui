import{A as B,at as Q,r as S,ax as D,B as i,av as o,E as l,D as s,ay as E,az as I,aw as _,aG as N,aI as c,U as R,C as d,ao as T,an as m,aJ as q,G as g,aK as f,aC as u,aL as r,aB as F,aM as p,aH as U,aE as L}from"./index.71301999.js";import{Q as V}from"./QScrollArea.34333c54.js";import{d as h}from"./dateTime.13d8e292.js";import"./format.2eeca912.js";import"./touch.70a9dd44.js";const b={class:"q-gutter-none full-height full-width"},G=["src"],z={class:"text-weight-bold"},W=B({__name:"message",emits:["emitChildren"],setup(H,{expose:C,emit:v}){const M=Q();let t=S([]);function k(a){v("emitChildren",{functionName:"selectContact",data:a}),t.value.forEach(e=>{e.friendUsername===a.friendUsername&&(e.unReadMessageCount=0)})}D.get("/v1/chat/chat/contacts/"+M.getUsername()).then(a=>{a.data.code==="00000"&&a.data.result&&(t.value=a.data.result)});function w(a,n){E.info("\u60A8\u6709\u4E00\u6761\u672A\u8BFB\u6D88\u606F"),t.value.forEach(e=>{e.contactId===a&&(e.unReadMessageCount+=1,e.lastMessage=n,e.lastSendAlias=e.remark,e.lastContactDateTime=h.now("hh:mm"))}),console.log(t.value)}function x(a,n){t.value.forEach(e=>{e.contactId===a&&(e.lastMessage=n,e.lastSendAlias=e.remark,e.lastContactDateTime=h.now("hh:mm"))}),console.log(t.value)}function A(a,n){t.value.forEach(e=>{e.contactId===a&&(e.lastMessage=n,e.lastSendAlias="\u6211",e.lastContactDateTime=h.now("hh:mm"))})}return C({receiveMessageNoCurrent:w,sendMessageCurrent:A,receiveMessageCurrent:x}),(a,n)=>(i(),o("div",b,[l(V,{class:"full-width full-height q-pa-xs"},{default:s(()=>[l(I,{class:"full-height full-width"},{default:s(()=>[(i(!0),o(_,null,N(c(t),(e,y)=>(i(),o(_,null,[R((i(),d(T,{class:"q-py-md q-mx-auto full-width",clickable:"",onClick:J=>k(e)},{default:s(()=>[l(m,{avatar:""},{default:s(()=>[l(q,null,{default:s(()=>[g("img",{src:e.avatar,alt:""},null,8,G)]),_:2},1024)]),_:2},1024),l(m,null,{default:s(()=>[l(f,{lines:"1"},{default:s(()=>[u(r(e.remark),1)]),_:2},1024),l(f,{caption:"",lines:"2",style:{"min-height":"29px"}},{default:s(()=>[g("span",z,r(e.lastSendAlias),1),u(" \uFF1A"+r(e.lastMessage),1)]),_:2},1024)]),_:2},1024),l(m,{side:"",top:""},{default:s(()=>[l(f,{caption:""},{default:s(()=>[u(r(e.lastContactDateTime),1)]),_:2},1024),e.unReadMessageCount!==0?(i(),d(F,{key:0,rounded:"",color:"red",class:"q-mt-xs"},{default:s(()=>[u(r(e.unReadMessageCount>99?"99+":e.unReadMessageCount),1)]),_:2},1024)):p("",!0)]),_:2},1024)]),_:2},1032,["onClick"])),[[U]]),y!==c(t).length-1?(i(),d(L,{key:0,inset:"item"})):p("",!0)],64))),256))]),_:1})]),_:1})]))}});export{W as default};
